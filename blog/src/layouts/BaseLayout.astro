---
import '../styles/global.css'; 
import { t } from '../i18n/utils'; 

interface Props {
	title: string;
    lang: 'en' | 'tr'; // Mevcut dili alıyoruz
}

const { title, lang } = Astro.props;
---

<html lang={lang}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>{title} | TSOF Blog</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:wght@300;400;700&family=Courier+Prime&display=swap" rel="stylesheet">
    <link rel="alternate" type="application/rss+xml" title="Sins of the Fathers Blog" href="/rss.xml" />
  </head>

  <body class="bg-[#050505] text-gray-300 font-sans min-h-screen selection:bg-[#c5a059] selection:text-black">
    
    <header class="border-b border-white/10 bg-black/50 backdrop-blur-md sticky top-0 z-50">
      <div class="container mx-auto px-6 py-4 flex justify-between items-center">
        <div class="flex items-center gap-4">
            <a href="/" class="text-xl font-serif text-[#c5a059] tracking-widest uppercase hover:text-white transition-colors">
              TSOF <span class="text-xs text-gray-600 ml-2">// {t(lang, 'blog_page.dossier_label')}</span> 
            </a>
            
            <div class="flex gap-2 font-mono text-[10px] ml-4 pt-0.5">
                <button class="lang-btn hover:text-[#c5a059] transition-colors" data-lang="en" onclick="window.changeBlogLanguage('en')">EN</button>
                <span class="text-gray-600">/</span>
                <button class="lang-btn hover:text-[#c5a059] transition-colors" data-lang="tr" onclick="window.changeBlogLanguage('tr')">TR</button>
            </div>
        </div>
        
        <a href="/" class="text-xs font-mono text-gray-500 hover:text-[#c5a059] transition-colors border border-white/10 px-3 py-1">
          {t(lang, 'blog_page.return_terminal')} &nbsp; &larr;
        </a>
      </div>
    </header>

    <main class="max-w-3xl mx-auto px-6 py-12">
        <slot />
    </main>

    <footer class="border-t border-white/5 py-8 mt-12 text-center bg-black">
      <p class="text-[10px] font-mono text-gray-600 uppercase tracking-widest">
        © 2025 The Sins of the Fathers. Tüm hakları saklıdır.
      </p>
    </footer>

    <script is:inline>
        // Client-side function to save preference and reload
        function changeBlogLanguage(targetLang) {
            // 1. Yerel depolamaya kaydet
            localStorage.setItem('tsof_blog_lang', targetLang);
            
            // 2. Cookie'ye kaydet (Bu, sunucunun okumasını sağlar)
            document.cookie = `tsof_blog_lang=${targetLang}; path=/; max-age=31536000`; 
            
            // 3. Sayfayı yenile
            window.location.reload(); 
        }
        window.changeBlogLanguage = changeBlogLanguage;

        // Butonların aktif halini ayarlama (Bu kısım aynı kalmalı)
        document.addEventListener('DOMContentLoaded', () => {
            const currentLang = localStorage.getItem('tsof_blog_lang') || 'tr'; 
            const activeBtn = document.querySelector(`.lang-btn[data-lang="${currentLang}"]`);
            if (activeBtn) {
                activeBtn.classList.add('text-white', 'font-bold', 'underline');
                activeBtn.classList.remove('text-gray-500');
            }
        });
    </script>
  </body>
</html>